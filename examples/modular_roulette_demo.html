<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëª¨ë“ˆí˜• ë£°ë › ë°ëª¨</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        .title {
            color: white;
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .controls {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .controls button {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .controls button:hover {
            transform: translateY(-2px);
        }

        .primary-btn {
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            color: white;
        }

        .secondary-btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }

        .info-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .roulette-container {
            position: fixed;
            width: 5000px;
            height: 5000px;
            top: 1000px;
            left: 50%;
            transform: translateX(-50%);
            overflow: hidden;
            pointer-events: auto;
        }

        .roulette-wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            background: #fff;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            cursor: grab;
        }

        .roulette-wheel:active {
            cursor: grabbing;
        }

        .center-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            background: #333;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }

        .pointer {
            position: absolute;
            top: 10px;
            left: 50%;
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 25px solid #333;
            transform: translateX(-50%);
            z-index: 5;
        }

        .result {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            min-width: 200px;
            display: none;
        }

        .status {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px;
            border-radius: 5px;
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 12px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <h1 class="title">ğŸ½ï¸ ëª¨ë“ˆí˜• ë£°ë › ì‹œìŠ¤í…œ</h1>
    
    <div class="controls">
        <button class="primary-btn" onclick="app.spin()">ğŸ² ë¬¼ë¦¬ ìŠ¤í•€</button>
        <button class="primary-btn" onclick="app.smoothSpin()">âœ¨ ë¶€ë“œëŸ¬ìš´ ìŠ¤í•€</button>
        <button class="secondary-btn" onclick="toggleCardStyle()">ğŸ”„ ì¹´ë“œ ìŠ¤íƒ€ì¼</button>
        <button class="secondary-btn" onclick="changeTopN()">ğŸ“Š TOP N ë³€ê²½</button>
        <button class="info-btn" onclick="showStatus()">ğŸ“‹ ìƒíƒœ í™•ì¸</button>
        <button class="info-btn" onclick="testSearch()">ğŸ” ê²€ìƒ‰ í…ŒìŠ¤íŠ¸</button>
    </div>
    
    <div class="roulette-container">
        <div class="pointer"></div>
        <div class="roulette-wheel" id="roulette">
            <div class="center-dot"></div>
        </div>
    </div>
    
    <div class="result" id="result">
        <h3>ğŸ‰ ì˜¤ëŠ˜ì˜ ì¶”ì²œ</h3>
        <p id="selected-menu"></p>
    </div>

    <div class="status" id="status">
        ì‹œìŠ¤í…œ ë¡œë”© ì¤‘...
    </div>

    <!-- ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
    <script src="../modules/MenuDataManager.js"></script>
    <script src="../modules/RouletteEngine.js"></script>
    <script src="../modules/CardRenderer.js"></script>
    <script src="../modules/RouletteApp.js"></script>

    <script>
        // ê¸€ë¡œë²Œ ì•± ì¸ìŠ¤í„´ìŠ¤
        let app;
        let currentTopN = 5;
        let currentStyle = 'category';

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.onload = function() {
            try {
                // ë£°ë › ì•± ì´ˆê¸°í™”
                app = new RouletteApp('.roulette-container', {
                    topN: currentTopN,
                    cardStyle: currentStyle,
                    onResult: function(selectedItem, index) {
                        console.log('Result:', selectedItem, 'Index:', index);
                        updateStatus(`ê²°ê³¼: ${selectedItem.title || selectedItem.name}`);
                    }
                });

                updateStatus('ì‹œìŠ¤í…œ ì¤€ë¹„ ì™„ë£Œ');
                
                // 5ì´ˆ í›„ ìƒíƒœì°½ ìˆ¨ê¸°ê¸°
                setTimeout(() => {
                    document.getElementById('status').style.display = 'none';
                }, 5000);

            } catch (error) {
                console.error('Initialization error:', error);
                updateStatus('ì´ˆê¸°í™” ì˜¤ë¥˜: ' + error.message);
            }
        };

        /**
         * ì¹´ë“œ ìŠ¤íƒ€ì¼ í† ê¸€
         */
        function toggleCardStyle() {
            currentStyle = currentStyle === 'category' ? 'menu' : 'category';
            app.setCardStyle(currentStyle);
            updateStatus(`ì¹´ë“œ ìŠ¤íƒ€ì¼: ${currentStyle}`);
        }

        /**
         * TOP N ë³€ê²½
         */
        function changeTopN() {
            const newTopN = currentTopN === 5 ? 7 : currentTopN === 7 ? 3 : 5;
            currentTopN = newTopN;
            app.setTopN(newTopN);
            updateStatus(`TOP ${newTopN} ì ìš©ë¨`);
        }

        /**
         * ìƒíƒœ ì •ë³´ í‘œì‹œ
         */
        function showStatus() {
            const state = app.getState();
            const info = `
ì¹´í…Œê³ ë¦¬: ${state.dataCount}ê°œ
ì¹´ë“œ: ${state.cardCount}ê°œ  
TOP: ${state.config.topN}
ìŠ¤íƒ€ì¼: ${state.config.cardStyle}
íšŒì „: ${state.engineState?.rotation.toFixed(1)}Â°
            `.trim();
            
            updateStatus(info);
            console.log('Full state:', state);
        }

        /**
         * ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
         */
        function testSearch() {
            const keywords = ['ì¹˜í‚¨', 'ë–¡ë³¶ì´', 'í”¼ì', 'ì´ˆë°¥'];
            const keyword = keywords[Math.floor(Math.random() * keywords.length)];
            const results = app.search(keyword);
            
            updateStatus(`"${keyword}" ê²€ìƒ‰: ${results.length}ê°œ ê²°ê³¼`);
            console.log('Search results:', results);
        }

        /**
         * íŠ¹ì • ê²°ê³¼ë¡œ ìŠ¤í•€ (ë°ëª¨ìš©)
         */
        function demoSpinToResult() {
            app.spinToResult('chicken'); // ì¹˜í‚¨ ì¹´í…Œê³ ë¦¬ë¡œ ìŠ¤í•€
        }

        /**
         * ìƒíƒœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
         */
        function updateStatus(message) {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.style.display = 'block';
            
            // 3ì´ˆ í›„ ìë™ ìˆ¨ê¹€
            setTimeout(() => {
                statusEl.style.display = 'none';
            }, 3000);
        }

        /**
         * í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
         */
        document.addEventListener('keydown', function(e) {
            switch(e.key) {
                case ' ': // ìŠ¤í˜ì´ìŠ¤ë°”
                    e.preventDefault();
                    app.spin();
                    break;
                case 'r': // Rí‚¤
                    app.smoothSpin();
                    break;
                case 't': // Tí‚¤
                    changeTopN();
                    break;
                case 's': // Sí‚¤
                    toggleCardStyle();
                    break;
                case 'h': // Hí‚¤
                    app.hideResult();
                    break;
            }
        });

        // ì „ì—­ í•¨ìˆ˜ë¡œ ë…¸ì¶œ (ë””ë²„ê¹…ìš©)
        window.rouletteApp = app;
    </script>
</body>
</html>